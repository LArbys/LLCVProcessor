#ifndef DEDXCALCULATOR_CXX
#define DEDXCALCULATOR_CXX

#include "dEdxCalculator.h"
#include <cassert>
#include <cmath>

namespace llcv {

  dEdxCalculator::dEdxCalculator() {
    //
    // https://goo.gl/oXkRQU
    //
    
    // fill muon
    _muon_m[90.50] = 2.07;
    _muon_m[90.00] = 2.07;
    _muon_m[89.50] = 2.07;
    _muon_m[89.00] = 2.07;
    _muon_m[88.50] = 2.07;
    _muon_m[88.00] = 2.07;
    _muon_m[87.50] = 2.07;
    _muon_m[87.00] = 2.07;
    _muon_m[86.50] = 2.07;
    _muon_m[86.00] = 2.07;
    _muon_m[85.50] = 2.07;
    _muon_m[85.00] = 2.07;
    _muon_m[84.50] = 2.07;
    _muon_m[84.00] = 2.07;
    _muon_m[83.50] = 2.07;
    _muon_m[83.00] = 2.07;
    _muon_m[82.50] = 2.07;
    _muon_m[82.00] = 2.07;
    _muon_m[81.50] = 2.07;
    _muon_m[81.00] = 2.07;
    _muon_m[80.50] = 2.07;
    _muon_m[80.00] = 2.07;
    _muon_m[79.50] = 2.08;
    _muon_m[79.00] = 2.08;
    _muon_m[78.50] = 2.08;
    _muon_m[78.00] = 2.08;
    _muon_m[77.50] = 2.08;
    _muon_m[77.00] = 2.08;
    _muon_m[76.50] = 2.08;
    _muon_m[76.00] = 2.08;
    _muon_m[75.50] = 2.08;
    _muon_m[75.00] = 2.08;
    _muon_m[74.50] = 2.08;
    _muon_m[74.00] = 2.08;
    _muon_m[73.50] = 2.08;
    _muon_m[73.00] = 2.08;
    _muon_m[72.50] = 2.08;
    _muon_m[72.00] = 2.08;
    _muon_m[71.50] = 2.08;
    _muon_m[71.00] = 2.08;
    _muon_m[70.50] = 2.09;
    _muon_m[70.00] = 2.09;
    _muon_m[69.50] = 2.09;
    _muon_m[69.00] = 2.09;
    _muon_m[68.50] = 2.09;
    _muon_m[68.00] = 2.09;
    _muon_m[67.50] = 2.09;
    _muon_m[67.00] = 2.09;
    _muon_m[66.50] = 2.09;
    _muon_m[66.00] = 2.09;
    _muon_m[65.50] = 2.09;
    _muon_m[65.00] = 2.09;
    _muon_m[64.50] = 2.10;
    _muon_m[64.00] = 2.10;
    _muon_m[63.50] = 2.10;
    _muon_m[63.00] = 2.10;
    _muon_m[62.50] = 2.10;
    _muon_m[62.00] = 2.10;
    _muon_m[61.50] = 2.10;
    _muon_m[61.00] = 2.10;
    _muon_m[60.50] = 2.10;
    _muon_m[60.00] = 2.11;
    _muon_m[59.50] = 2.11;
    _muon_m[59.00] = 2.11;
    _muon_m[58.50] = 2.11;
    _muon_m[58.00] = 2.11;
    _muon_m[57.50] = 2.11;
    _muon_m[57.00] = 2.11;
    _muon_m[56.50] = 2.11;
    _muon_m[56.00] = 2.12;
    _muon_m[55.50] = 2.12;
    _muon_m[55.00] = 2.12;
    _muon_m[54.50] = 2.12;
    _muon_m[54.00] = 2.12;
    _muon_m[53.50] = 2.12;
    _muon_m[53.00] = 2.13;
    _muon_m[52.50] = 2.13;
    _muon_m[52.00] = 2.13;
    _muon_m[51.50] = 2.13;
    _muon_m[51.00] = 2.13;
    _muon_m[50.50] = 2.14;
    _muon_m[50.00] = 2.14;
    _muon_m[49.50] = 2.14;
    _muon_m[49.00] = 2.14;
    _muon_m[48.50] = 2.14;
    _muon_m[48.00] = 2.15;
    _muon_m[47.50] = 2.15;
    _muon_m[47.00] = 2.15;
    _muon_m[46.50] = 2.15;
    _muon_m[46.00] = 2.16;
    _muon_m[45.50] = 2.16;
    _muon_m[45.00] = 2.16;
    _muon_m[44.50] = 2.16;
    _muon_m[44.00] = 2.17;
    _muon_m[43.50] = 2.17;
    _muon_m[43.00] = 2.17;
    _muon_m[42.50] = 2.18;
    _muon_m[42.00] = 2.18;
    _muon_m[41.50] = 2.18;
    _muon_m[41.00] = 2.19;
    _muon_m[40.50] = 2.19;
    _muon_m[40.00] = 2.19;
    _muon_m[39.50] = 2.20;
    _muon_m[39.00] = 2.20;
    _muon_m[38.50] = 2.20;
    _muon_m[38.00] = 2.21;
    _muon_m[37.50] = 2.21;
    _muon_m[37.00] = 2.22;
    _muon_m[36.50] = 2.22;
    _muon_m[36.00] = 2.23;
    _muon_m[35.50] = 2.23;
    _muon_m[35.00] = 2.23;
    _muon_m[34.50] = 2.24;
    _muon_m[34.00] = 2.24;
    _muon_m[33.50] = 2.25;
    _muon_m[33.00] = 2.25;
    _muon_m[32.50] = 2.26;
    _muon_m[32.00] = 2.27;
    _muon_m[31.50] = 2.27;
    _muon_m[31.00] = 2.28;
    _muon_m[30.50] = 2.28;
    _muon_m[30.00] = 2.29;
    _muon_m[29.50] = 2.30;
    _muon_m[29.00] = 2.30;
    _muon_m[28.50] = 2.31;
    _muon_m[28.00] = 2.32;
    _muon_m[27.50] = 2.33;
    _muon_m[27.00] = 2.33;
    _muon_m[26.50] = 2.34;
    _muon_m[26.00] = 2.35;
    _muon_m[25.50] = 2.36;
    _muon_m[25.00] = 2.37;
    _muon_m[24.50] = 2.38;
    _muon_m[24.00] = 2.39;
    _muon_m[23.50] = 2.40;
    _muon_m[23.00] = 2.41;
    _muon_m[22.50] = 2.42;
    _muon_m[22.00] = 2.43;
    _muon_m[21.50] = 2.44;
    _muon_m[21.00] = 2.45;
    _muon_m[20.50] = 2.47;
    _muon_m[20.00] = 2.48;
    _muon_m[19.50] = 2.49;
    _muon_m[19.00] = 2.51;
    _muon_m[18.50] = 2.52;
    _muon_m[18.00] = 2.54;
    _muon_m[17.50] = 2.56;
    _muon_m[17.00] = 2.57;
    _muon_m[16.50] = 2.59;
    _muon_m[16.00] = 2.61;
    _muon_m[15.50] = 2.63;
    _muon_m[15.00] = 2.66;
    _muon_m[14.50] = 2.68;
    _muon_m[14.00] = 2.70;
    _muon_m[13.50] = 2.73;
    _muon_m[13.00] = 2.76;
    _muon_m[12.50] = 2.79;
    _muon_m[12.00] = 2.82;
    _muon_m[11.50] = 2.85;
    _muon_m[11.00] = 2.89;
    _muon_m[10.50] = 2.93;
    _muon_m[10.00] = 2.97;
    _muon_m[9.50] = 3.02;
    _muon_m[9.00] = 3.07;
    _muon_m[8.50] = 3.12;
    _muon_m[8.00] = 3.18;
    _muon_m[7.50] = 3.25;
    _muon_m[7.00] = 3.32;
    _muon_m[6.50] = 3.40;
    _muon_m[6.00] = 3.49;
    _muon_m[5.50] = 3.60;
    _muon_m[5.00] = 3.72;
    _muon_m[4.50] = 3.86;
    _muon_m[4.00] = 4.03;
    _muon_m[3.50] = 4.23;
    _muon_m[3.00] = 4.49;
    _muon_m[2.50] = 4.81;
    _muon_m[2.00] = 5.24;
    _muon_m[1.50] = 5.87;
    _muon_m[1.00] = 6.89;
    _muon_m[0.50] = 8.92;
    _muon_m[0.00] = 16.29;;
    
    // fill proton
    _proton_m[84.5] = 3.00;
    _proton_m[84.0] = 3.01;
    _proton_m[83.5] = 3.01;
    _proton_m[83.0] = 3.02;
    _proton_m[82.5] = 3.02;
    _proton_m[82.0] = 3.03;
    _proton_m[81.5] = 3.03;
    _proton_m[81.0] = 3.04;
    _proton_m[80.5] = 3.05;
    _proton_m[80.0] = 3.05;
    _proton_m[79.5] = 3.06;
    _proton_m[79.0] = 3.06;
    _proton_m[78.5] = 3.07;
    _proton_m[78.0] = 3.08;
    _proton_m[77.5] = 3.08;
    _proton_m[77.0] = 3.09;
    _proton_m[76.5] = 3.09;
    _proton_m[76.0] = 3.10;
    _proton_m[75.5] = 3.11;
    _proton_m[75.0] = 3.11;
    _proton_m[74.5] = 3.12;
    _proton_m[74.0] = 3.12;
    _proton_m[73.5] = 3.13;
    _proton_m[73.0] = 3.14;
    _proton_m[72.5] = 3.14;
    _proton_m[72.0] = 3.15;
    _proton_m[71.5] = 3.16;
    _proton_m[71.0] = 3.17;
    _proton_m[70.5] = 3.17;
    _proton_m[70.0] = 3.18;
    _proton_m[69.5] = 3.19;
    _proton_m[69.0] = 3.19;
    _proton_m[68.5] = 3.20;
    _proton_m[68.0] = 3.21;
    _proton_m[67.5] = 3.22;
    _proton_m[67.0] = 3.22;
    _proton_m[66.5] = 3.23;
    _proton_m[66.0] = 3.24;
    _proton_m[65.5] = 3.25;
    _proton_m[65.0] = 3.25;
    _proton_m[64.5] = 3.26;
    _proton_m[64.0] = 3.27;
    _proton_m[63.5] = 3.28;
    _proton_m[63.0] = 3.29;
    _proton_m[62.5] = 3.30;
    _proton_m[62.0] = 3.30;
    _proton_m[61.5] = 3.31;
    _proton_m[61.0] = 3.32;
    _proton_m[60.5] = 3.33;
    _proton_m[60.0] = 3.34;
    _proton_m[59.5] = 3.35;
    _proton_m[59.0] = 3.36;
    _proton_m[58.5] = 3.37;
    _proton_m[58.0] = 3.38;
    _proton_m[57.5] = 3.39;
    _proton_m[57.0] = 3.40;
    _proton_m[56.5] = 3.41;
    _proton_m[56.0] = 3.42;
    _proton_m[55.5] = 3.43;
    _proton_m[55.0] = 3.44;
    _proton_m[54.5] = 3.45;
    _proton_m[54.0] = 3.46;
    _proton_m[53.5] = 3.47;
    _proton_m[53.0] = 3.48;
    _proton_m[52.5] = 3.49;
    _proton_m[52.0] = 3.50;
    _proton_m[51.5] = 3.51;
    _proton_m[51.0] = 3.52;
    _proton_m[50.5] = 3.54;
    _proton_m[50.0] = 3.55;
    _proton_m[49.5] = 3.56;
    _proton_m[49.0] = 3.57;
    _proton_m[48.5] = 3.58;
    _proton_m[48.0] = 3.60;
    _proton_m[47.5] = 3.61;
    _proton_m[47.0] = 3.62;
    _proton_m[46.5] = 3.64;
    _proton_m[46.0] = 3.65;
    _proton_m[45.5] = 3.66;
    _proton_m[45.0] = 3.68;
    _proton_m[44.5] = 3.69;
    _proton_m[44.0] = 3.71;
    _proton_m[43.5] = 3.72;
    _proton_m[43.0] = 3.74;
    _proton_m[42.5] = 3.75;
    _proton_m[42.0] = 3.77;
    _proton_m[41.5] = 3.78;
    _proton_m[41.0] = 3.80;
    _proton_m[40.5] = 3.82;
    _proton_m[40.0] = 3.83;
    _proton_m[39.5] = 3.85;
    _proton_m[39.0] = 3.87;
    _proton_m[38.5] = 3.89;
    _proton_m[38.0] = 3.90;
    _proton_m[37.5] = 3.92;
    _proton_m[37.0] = 3.94;
    _proton_m[36.5] = 3.96;
    _proton_m[36.0] = 3.98;
    _proton_m[35.5] = 4.00;
    _proton_m[35.0] = 4.02;
    _proton_m[34.5] = 4.04;
    _proton_m[34.0] = 4.06;
    _proton_m[33.5] = 4.09;
    _proton_m[33.0] = 4.11;
    _proton_m[32.5] = 4.13;
    _proton_m[32.0] = 4.15;
    _proton_m[31.5] = 4.18;
    _proton_m[31.0] = 4.20;
    _proton_m[30.5] = 4.23;
    _proton_m[30.0] = 4.26;
    _proton_m[29.5] = 4.28;
    _proton_m[29.0] = 4.31;
    _proton_m[28.5] = 4.34;
    _proton_m[28.0] = 4.37;
    _proton_m[27.5] = 4.40;
    _proton_m[27.0] = 4.43;
    _proton_m[26.5] = 4.46;
    _proton_m[26.0] = 4.49;
    _proton_m[25.5] = 4.52;
    _proton_m[25.0] = 4.56;
    _proton_m[24.5] = 4.59;
    _proton_m[24.0] = 4.63;
    _proton_m[23.5] = 4.67;
    _proton_m[23.0] = 4.71;
    _proton_m[22.5] = 4.75;
    _proton_m[22.0] = 4.79;
    _proton_m[21.5] = 4.83;
    _proton_m[21.0] = 4.88;
    _proton_m[20.5] = 4.92;
    _proton_m[20.0] = 4.97;
    _proton_m[19.5] = 5.02;
    _proton_m[19.0] = 5.07;
    _proton_m[18.5] = 5.13;
    _proton_m[18.0] = 5.18;
    _proton_m[17.5] = 5.24;
    _proton_m[17.0] = 5.30;
    _proton_m[16.5] = 5.37;
    _proton_m[16.0] = 5.43;
    _proton_m[15.5] = 5.50;
    _proton_m[15.0] = 5.58;
    _proton_m[14.5] = 5.66;
    _proton_m[14.0] = 5.74;
    _proton_m[13.5] = 5.83;
    _proton_m[13.0] = 5.92;
    _proton_m[12.5] = 6.01;
    _proton_m[12.0] = 6.12;
    _proton_m[11.5] = 6.23;
    _proton_m[11.0] = 6.35;
    _proton_m[10.5] = 6.47;
    _proton_m[10.0] = 6.61;
    _proton_m[9.50] = 6.75;
    _proton_m[9.00] = 6.91;
    _proton_m[8.50] = 7.09;
    _proton_m[8.00] = 7.28;
    _proton_m[7.50] = 7.48;
    _proton_m[7.00] = 7.71;
    _proton_m[6.50] = 7.97;
    _proton_m[6.00] = 8.26;
    _proton_m[5.50] = 8.59;
    _proton_m[5.00] = 8.97;
    _proton_m[4.50] = 9.41;
    _proton_m[4.00] = 9.94;
    _proton_m[3.50] = 10.58;
    _proton_m[3.00] = 11.38;
    _proton_m[2.50] = 12.42;
    _proton_m[2.00] = 13.86;
    _proton_m[1.50] = 16.00;
    _proton_m[1.00] = 19.72;
    _proton_m[0.50] = 28.53;
    _proton_m[0.00] = 129.59;
  }

  float dEdxCalculator::ProtonEstimate(float rr) {
    if (rr>84.5) return 3.0;
    float r = std::round(2.0*rr)/2.0;
    return _proton_m[r];
  }
  float dEdxCalculator::MuonEstimate(float rr) {
    if (rr>90.50) return 2.07;
    float r = std::round(2.0*rr)/2.0;
    return _muon_m[r];
  }


}


#endif
